#!/usr/bin/env bash

# Usage: ./bin/make-gke-test-cluster <project> <zone> <clustername>
#   Configure two kubernetes clusters for running pool-based integration tests and running pools in general.
#    NOTE: This script labels any clusters it creates and will DELETE old clusters it created.
#   <project> is a gcloud project.
#   <zone> can be a zone. E.g., us-central1-a
#   <clustername> is the name of a cluster. E.g., 'test-cluster-1'

set -e

PROJECT=$1
ZONE=$2
CLUSTERNAME=$3

bin/help-delete-temporary-clusters $ZONE

# Make 2 clusters.
bin/help-make-cluster $PROJECT $ZONE ${CLUSTERNAME}-a .cook_kubeconfig_1 &
bin/help-make-cluster $PROJECT $ZONE ${CLUSTERNAME}-b .cook_kubeconfig_2 &
wait


echo "---- Showing all of the clusters we generated"
gcloud container clusters list


